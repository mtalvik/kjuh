<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Majaka tn 54 Invoice Splitter</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .input-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .invoice {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .invoice-header {
            text-align: center;
            border-bottom: 2px solid #333;
            padding-bottom: 15px;
            margin-bottom: 25px;
        }
        
        .invoice-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 25px;
        }
        
        .company-info {
            font-weight: bold;
        }
        
        .invoice-details {
            text-align: right;
        }
        
        .apartment-info {
            margin-bottom: 25px;
            text-align: center;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
        }
        
        .invoice-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
        }
        
        .invoice-table th,
        .invoice-table td {
            border: 1px solid #333;
            padding: 8px;
            text-align: left;
            font-size: 12px;
        }
        
        .invoice-table th {
            background-color: #e0e0e0;
            font-weight: bold;
            text-align: center;
        }
        
        .amount {
            text-align: right;
        }
        
        .total-row {
            font-weight: bold;
            background-color: #f0f0f0;
        }
        
        .input-group {
            margin-bottom: 10px;
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 10px;
            align-items: center;
        }
        
        .input-group label {
            font-weight: bold;
        }
        
        .input-group input {
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }
        
        .calculate-btn {
            background-color: #007bff;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }
        
        .calculate-btn:hover {
            background-color: #0056b3;
        }
        
        .rates-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .meters-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .meter-section {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
        }
        
        .meter-section h4 {
            margin: 0 0 10px 0;
            font-size: 14px;
            color: #333;
        }
        
        .korter1-col {
            background-color: #f9f9f9;
        }
        
        .korter2-col {
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Majaka tn 54 Invoice Splitter</h1>
        
        <div class="input-section">
            <h2>Invoice Input</h2>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 20px;">
                <div class="input-group">
                    <label>Invoice Number:</label>
                    <input type="text" id="invoiceNumber" value="25069">
                </div>
                <div class="input-group">
                    <label>Period:</label>
                    <input type="text" id="period" value="05/2025">
                </div>
                <div class="input-group">
                    <label>Invoice Date:</label>
                    <input type="date" id="invoiceDate" value="2025-05-31">
                </div>
                <div class="input-group">
                    <label>Due Date:</label>
                    <input type="date" id="dueDate" value="2025-06-30">
                </div>
            </div>
            
            <h3>Shared Costs (per m²)</h3>
            <div class="rates-grid">
                <div class="input-group">
                    <label>Haldustasu:</label>
                    <input type="number" id="haldustasu" value="0.3689" step="0.0001">
                </div>
                <div class="input-group">
                    <label>Remondifond:</label>
                    <input type="number" id="remondifond" value="0.2347" step="0.0001">
                </div>
                <div class="input-group">
                    <label>Üldelekter:</label>
                    <input type="number" id="uldelekter" value="0.04017" step="0.00001">
                </div>
                <div class="input-group">
                    <label>Üldelekter (krt 9):</label>
                    <input type="number" id="uldelekterKrt9" value="0.09650" step="0.00001">
                </div>
                <div class="input-group">
                    <label>Küte:</label>
                    <input type="number" id="kute" value="0.39148" step="0.00001">
                </div>
                <div class="input-group">
                    <label>Prügivedu:</label>
                    <input type="number" id="prugivedu" value="0.07631" step="0.00001">
                </div>
            </div>
            
            <h3>Utility Rates</h3>
            <div class="rates-grid">
                <div class="input-group">
                    <label>Elekter (päevane):</label>
                    <input type="number" id="elektrPaevane" value="0.151487" step="0.000001">
                </div>
                <div class="input-group">
                    <label>Elekter (öine):</label>
                    <input type="number" id="elektrOine" value="0.116266" step="0.000001">
                </div>
                <div class="input-group">
                    <label>Vesi:</label>
                    <input type="number" id="vesi" value="2.5620" step="0.0001">
                </div>
                <div class="input-group">
                    <label>Vee soojendamine:</label>
                    <input type="number" id="veeSoojendamine" value="4.343994" step="0.000001">
                </div>
            </div>
            
            <h3>Meter Readings</h3>
            <div class="meters-grid">
                <div class="meter-section">
                    <h4>Külm vesi 1 (K1)</h4>
                    <div class="input-group">
                        <label>Algn:</label>
                        <input type="number" id="kulmVesi1Algn" value="172.230" step="0.001">
                    </div>
                    <div class="input-group">
                        <label>Lõpp:</label>
                        <input type="number" id="kulmVesi1Lopp" value="174.240" step="0.001">
                    </div>
                </div>
                
                <div class="meter-section">
                    <h4>Külm vesi 2 (K2)</h4>
                    <div class="input-group">
                        <label>Algn:</label>
                        <input type="number" id="kulmVesi2Algn" value="165.600" step="0.001">
                    </div>
                    <div class="input-group">
                        <label>Lõpp:</label>
                        <input type="number" id="kulmVesi2Lopp" value="165.980" step="0.001">
                    </div>
                </div>
                
                <div class="meter-section">
                    <h4>Soe vesi 1 (K1)</h4>
                    <div class="input-group">
                        <label>Algn:</label>
                        <input type="number" id="soeVesi1Algn" value="120.430" step="0.001">
                    </div>
                    <div class="input-group">
                        <label>Lõpp:</label>
                        <input type="number" id="soeVesi1Lopp" value="122.830" step="0.001">
                    </div>
                </div>
                
                <div class="meter-section">
                    <h4>Soe vesi 2 (K2)</h4>
                    <div class="input-group">
                        <label>Algn:</label>
                        <input type="number" id="soeVesi2Algn" value="20.010" step="0.001">
                    </div>
                    <div class="input-group">
                        <label>Lõpp:</label>
                        <input type="number" id="soeVesi2Lopp" value="20.160" step="0.001">
                    </div>
                </div>
                
                <div class="meter-section">
                    <h4>Päev elekter 1 (K1)</h4>
                    <div class="input-group">
                        <label>Algn:</label>
                        <input type="number" id="paevaneElekter1Algn" value="2920.650" step="0.001">
                    </div>
                    <div class="input-group">
                        <label>Lõpp:</label>
                        <input type="number" id="paevaneElekter1Lopp" value="2969.710" step="0.001">
                    </div>
                </div>
                
                <div class="meter-section">
                    <h4>Päev elekter 2 (K2)</h4>
                    <div class="input-group">
                        <label>Algn:</label>
                        <input type="number" id="paevaneElekter2Algn" value="3866.190" step="0.001">
                    </div>
                    <div class="input-group">
                        <label>Lõpp:</label>
                        <input type="number" id="paevaneElekter2Lopp" value="3884.910" step="0.001">
                    </div>
                </div>
                
                <div class="meter-section">
                    <h4>Öö elekter 1 (K1)</h4>
                    <div class="input-group">
                        <label>Algn:</label>
                        <input type="number" id="oineElekter1Algn" value="2670.590" step="0.001">
                    </div>
                    <div class="input-group">
                        <label>Lõpp:</label>
                        <input type="number" id="oineElekter1Lopp" value="2731.950" step="0.001">
                    </div>
                </div>
                
                <div class="meter-section">
                    <h4>Öö elekter 2 (K2)</h4>
                    <div class="input-group">
                        <label>Algn:</label>
                        <input type="number" id="oineElekter2Algn" value="3231.600" step="0.001">
                    </div>
                    <div class="input-group">
                        <label>Lõpp:</label>
                        <input type="number" id="oineElekter2Lopp" value="3246.740" step="0.001">
                    </div>
                </div>
            </div>
            
            <button class="calculate-btn" onclick="generateInvoice()">Generate Split Invoice</button>
        </div>
        
        <div id="invoiceContainer">
            <!-- Generated invoice will appear here -->
        </div>
    </div>

    <script>
        const TOTAL_AREA = 79.90;
        const KORTER1_INDEX = 0.45557;
        const KORTER2_INDEX = 0.54443;
        const KORTER1_AREA = TOTAL_AREA * KORTER1_INDEX;
        const KORTER2_AREA = TOTAL_AREA * KORTER2_INDEX;

        function getInputValue(id) {
            return parseFloat(document.getElementById(id).value) || 0;
        }

        function formatNumber(num, decimals = 2) {
            return num.toFixed(decimals);
        }

        function generateInvoice() {
            console.log('Generating split invoice...');
            
            const invoiceNumber = document.getElementById('invoiceNumber').value;
            const invoiceDate = document.getElementById('invoiceDate').value;
            const dueDate = document.getElementById('dueDate').value;
            const period = document.getElementById('period').value;

            // Get rates
            const haldustasu = getInputValue('haldustasu');
            const remondifond = getInputValue('remondifond');
            const uldelekter = getInputValue('uldelekter');
            const uldelekterKrt9 = getInputValue('uldelekterKrt9');
            const kute = getInputValue('kute');
            const prugivedu = getInputValue('prugivedu');
            const elektrPaevane = getInputValue('elektrPaevane');
            const elektrOine = getInputValue('elektrOine');
            const vesi = getInputValue('vesi');
            const veeSoojendamine = getInputValue('veeSoojendamine');

            // Calculate consumptions
            const kulmVesi1 = getInputValue('kulmVesi1Lopp') - getInputValue('kulmVesi1Algn');
            const kulmVesi2 = getInputValue('kulmVesi2Lopp') - getInputValue('kulmVesi2Algn');
            const soeVesi1 = getInputValue('soeVesi1Lopp') - getInputValue('soeVesi1Algn');
            const soeVesi2 = getInputValue('soeVesi2Lopp') - getInputValue('soeVesi2Algn');
            const paevaneElekter1 = getInputValue('paevaneElekter1Lopp') - getInputValue('paevaneElekter1Algn');
            const paevaneElekter2 = getInputValue('paevaneElekter2Lopp') - getInputValue('paevaneElekter2Algn');
            const oineElekter1 = getInputValue('oineElekter1Lopp') - getInputValue('oineElekter1Algn');
            const oineElekter2 = getInputValue('oineElekter2Lopp') - getInputValue('oineElekter2Algn');

            // Calculate costs for Korter 1
            const k1_haldustasu = KORTER1_AREA * haldustasu;
            const k1_remondifond = KORTER1_AREA * remondifond;
            const k1_uldelekter = KORTER1_AREA * uldelekter;
            const k1_uldelekterKrt9 = KORTER1_AREA * uldelekterKrt9;
            const k1_kute = KORTER1_AREA * kute;
            const k1_prugivedu = KORTER1_AREA * prugivedu;
            const k1_elektrPaevane = paevaneElekter1 * elektrPaevane;
            const k1_elektrOine = oineElekter1 * elektrOine;
            const k1_vesi = kulmVesi1 * vesi;
            const k1_veeSoojendamine = soeVesi1 * veeSoojendamine;

            // Calculate costs for Korter 2
            const k2_haldustasu = KORTER2_AREA * haldustasu;
            const k2_remondifond = KORTER2_AREA * remondifond;
            const k2_uldelekter = KORTER2_AREA * uldelekter;
            const k2_uldelekterKrt9 = KORTER2_AREA * uldelekterKrt9;
            const k2_kute = KORTER2_AREA * kute;
            const k2_prugivedu = KORTER2_AREA * prugivedu;
            const k2_elektrPaevane = paevaneElekter2 * elektrPaevane;
            const k2_elektrOine = oineElekter2 * elektrOine;
            const k2_vesi = kulmVesi2 * vesi;
            const k2_veeSoojendamine = soeVesi2 * veeSoojendamine;

            // Calculate totals
            const total1 = k1_haldustasu + k1_remondifond + k1_uldelekter + k1_uldelekterKrt9 + k1_kute + k1_prugivedu + k1_elektrPaevane + k1_elektrOine + k1_vesi + k1_veeSoojendamine;
            const total2 = k2_haldustasu + k2_remondifond + k2_uldelekter + k2_uldelekterKrt9 + k2_kute + k2_prugivedu + k2_elektrPaevane + k2_elektrOine + k2_vesi + k2_veeSoojendamine;
            const grandTotal = total1 + total2;

            const invoice = `
                <div class="invoice">
                    <div class="invoice-header">
                        <h1>MAJAKA TN 54 KÜ</h1>
                        <p>Majaka tn 54, 11412 Tallinn, Reg. nr 80541496</p>
                    </div>
                    
                    <div class="invoice-info">
                        <div class="company-info">
                            <strong>MARIA TALVIK</strong><br>
                            Majaka tn 54-9<br>
                            11412 Tallinn
                        </div>
                        <div class="invoice-details">
                            <strong>ARVE nr ${invoiceNumber}</strong><br>
                            Kuupäev ${invoiceDate}<br>
                            Maksetähtaeg ${dueDate}<br>
                            Viivis 0.022% päevas<br>
                            Viitenumber 97<br>
                            SWEDBANK EE772200221071147195
                        </div>
                    </div>
                    
                    <div class="apartment-info">
                        <strong>Korter Majaka tn 54-9</strong><br>
                        Kogupind ${formatNumber(TOTAL_AREA)} m²
                    </div>
                    
                    <table class="invoice-table">
                        <thead>
                            <tr>
                                <th>Kululiik</th>
                                <th>Periood</th>
                                <th>Kogus</th>
                                <th>Ühik</th>
                                <th>Hind</th>
                                <th>Summa</th>
                                <th>Korter 1</th>
                                <th>Korter 2</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Haldustasu</td>
                                <td>${period}</td>
                                <td>${formatNumber(TOTAL_AREA, 1)}</td>
                                <td>m²</td>
                                <td>${formatNumber(haldustasu, 4)}</td>
                                <td class="amount">${formatNumber(k1_haldustasu + k2_haldustasu)}</td>
                                <td class="amount">${formatNumber(k1_haldustasu)}</td>
                                <td class="amount">${formatNumber(k2_haldustasu)}</td>
                            </tr>
                            <tr>
                                <td>Remondifond</td>
                                <td>${period}</td>
                                <td>${formatNumber(TOTAL_AREA, 1)}</td>
                                <td>m²</td>
                                <td>${formatNumber(remondifond, 4)}</td>
                                <td class="amount">${formatNumber(k1_remondifond + k2_remondifond)}</td>
                                <td class="amount">${formatNumber(k1_remondifond)}</td>
                                <td class="amount">${formatNumber(k2_remondifond)}</td>
                            </tr>
                            <tr>
                                <td>Üldelekter</td>
                                <td>${period}</td>
                                <td>${formatNumber(TOTAL_AREA, 1)}</td>
                                <td>m²</td>
                                <td>${formatNumber(uldelekter, 5)}</td>
                                <td class="amount">${formatNumber(k1_uldelekter + k2_uldelekter)}</td>
                                <td class="amount">${formatNumber(k1_uldelekter)}</td>
                                <td class="amount">${formatNumber(k2_uldelekter)}</td>
                            </tr>
                            <tr>
                                <td>Üldelekter (krt 9)</td>
                                <td>${period}</td>
                                <td>${formatNumber(TOTAL_AREA, 1)}</td>
                                <td>m²</td>
                                <td>${formatNumber(uldelekterKrt9, 5)}</td>
                                <td class="amount">${formatNumber(k1_uldelekterKrt9 + k2_uldelekterKrt9)}</td>
                                <td class="amount">${formatNumber(k1_uldelekterKrt9)}</td>
                                <td class="amount">${formatNumber(k2_uldelekterKrt9)}</td>
                            </tr>
                            <tr>
                                <td>Elekter (päevane)</td>
                                <td>${period}</td>
                                <td>${formatNumber(paevaneElekter1 + paevaneElekter2, 2)}</td>
                                <td>kWh</td>
                                <td>${formatNumber(elektrPaevane, 6)}</td>
                                <td class="amount">${formatNumber(k1_elektrPaevane + k2_elektrPaevane)}</td>
                                <td class="amount">${formatNumber(k1_elektrPaevane)}</td>
                                <td class="amount">${formatNumber(k2_elektrPaevane)}</td>
                            </tr>
                            <tr>
                                <td>Elekter (öine)</td>
                                <td>${period}</td>
                                <td>${formatNumber(oineElekter1 + oineElekter2, 1)}</td>
                                <td>kWh</td>
                                <td>${formatNumber(elektrOine, 6)}</td>
                                <td class="amount">${formatNumber(k1_elektrOine + k2_elektrOine)}</td>
                                <td class="amount">${formatNumber(k1_elektrOine)}</td>
                                <td class="amount">${formatNumber(k2_elektrOine)}</td>
                            </tr>
                            <tr>
                                <td>Vesi</td>
                                <td>${period}</td>
                                <td>${formatNumber(kulmVesi1 + kulmVesi2, 2)}</td>
                                <td>m³</td>
                                <td>${formatNumber(vesi, 4)}</td>
                                <td class="amount">${formatNumber(k1_vesi + k2_vesi)}</td>
                                <td class="amount">${formatNumber(k1_vesi)}</td>
                                <td class="amount">${formatNumber(k2_vesi)}</td>
                            </tr>
                            <tr>
                                <td>Küte</td>
                                <td>${period}</td>
                                <td>${formatNumber(TOTAL_AREA, 1)}</td>
                                <td>m²</td>
                                <td>${formatNumber(kute, 5)}</td>
                                <td class="amount">${formatNumber(k1_kute + k2_kute)}</td>
                                <td class="amount">${formatNumber(k1_kute)}</td>
                                <td class="amount">${formatNumber(k2_kute)}</td>
                            </tr>
                            <tr>
                                <td>Vee soojendamine</td>
                                <td>${period}</td>
                                <td>${formatNumber(soeVesi1 + soeVesi2, 2)}</td>
                                <td>m³</td>
                                <td>${formatNumber(veeSoojendamine, 6)}</td>
                                <td class="amount">${formatNumber(k1_veeSoojendamine + k2_veeSoojendamine)}</td>
                                <td class="amount">${formatNumber(k1_veeSoojendamine)}</td>
                                <td class="amount">${formatNumber(k2_veeSoojendamine)}</td>
                            </tr>
                            <tr>
                                <td>Prügivedu</td>
                                <td>${period}</td>
                                <td>${formatNumber(TOTAL_AREA, 1)}</td>
                                <td>m²</td>
                                <td>${formatNumber(prugivedu, 5)}</td>
                                <td class="amount">${formatNumber(k1_prugivedu + k2_prugivedu)}</td>
                                <td class="amount">${formatNumber(k1_prugivedu)}</td>
                                <td class="amount">${formatNumber(k2_prugivedu)}</td>
                            </tr>
                            <tr class="total-row">
                                <td colspan="5"><strong>Kokku (EUR)</strong></td>
                                <td class="amount"><strong>${formatNumber(grandTotal)}</strong></td>
                                <td class="amount"><strong>${formatNumber(total1)}</strong></td>
                                <td class="amount"><strong>${formatNumber(total2)}</strong></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div style="margin: 25px 0;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                            <div>
                                <div>Võlg (seisuga ${invoiceDate}): 0.00</div>
                                <div>Arvestatud viivised: 0.05</div>
                                <div><strong>Tasumisele kuulub (EUR): ${formatNumber(grandTotal + 0.05)}</strong></div>
                            </div>
                            <div style="text-align: center;">
                                <h4 style="margin: 0 0 10px 0;">KORTER 1</h4>
                                <div><strong>${formatNumber(total1)} EUR</strong></div>
                            </div>
                            <div style="text-align: center;">
                                <h4 style="margin: 0 0 10px 0;">KORTER 2</h4>
                                <div><strong>${formatNumber(total2)} EUR</strong></div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; font-size: 12px; color: #666; text-align: center;">
                        <div>Kasutame www.korto.ee veebitarkvara</div>
                        <div>Powered by TCPDF (www.tcpdf.org)</div>
                    </div>
                </div>
            `;

            document.getElementById('invoiceContainer').innerHTML = invoice;
        }
    </script>
</body>
</html>
